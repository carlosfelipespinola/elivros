
<div class="container" style="max-width: 400px; margin: auto;">
<div class="row">
  <div class="column">
    <%= file_field_tag 'imagem_capa', style: "display: none", accept: "image/*", id: "input-imagem-capa", :required => true %>
    <img id="img-placeholder" class="ui fluid image" src="/public<%= atributo_ou_string_vazia(livro, :url_capa) %>">
  </div>
<br>
<label for="input-imagem-capa" class="fluid ui button">
  Adicionar imagem
</label>
<br>
</div>
</div>

<div class="three fields">
  <div class="field">    
    <label>Titulo</label>
    <%= text_field_tag 'titulo', atributo_ou_string_vazia(livro, :titulo), required: true %>
  </div>
  <div class="field">
    <label>Editora</label>
    <%= text_field_tag 'editora', atributo_ou_string_vazia(livro, :editora), required: true %>
  </div>
  <div class="field">
    <label>Data publicação</label>
    <%= date_field 'data_publicacao', atributo_ou_string_vazia(livro, :data_publicacao), required: true %>
  </div>
</div>



<div class="two fields">
<div class="field">
  <label>Categorias</label>
  <select multiple="" class="ui dropdown" name="generos[]" required>
    <% @categorias.each do |categoria| %>
      <option value="<%= categoria %>"> <%= categoria.sub("-"," ").capitalize %> </option>
    <% end %>
  </select>
</div>

<div class="field">
  <label>PDF:</label>
  <%= file_field_tag :pdf, style: "padding: 7px" %>
</div>

</div>

<div class="field">
  <label>Descrição</label>
  <textarea name="descricao" required ></textarea>
</div>


<% content_for :javascript do %>
  <script>
    (function(){

      function lerImagem(event){
        let fileList = event.target.files;
        let reader = new FileReader();
        reader.onload = (ev) => {
          render(ev.target['result'])
        }
        reader.readAsDataURL(fileList[0]);
      }

      function render(img){
        $("#img-placeholder").attr('src',img);
      }

      $("#input-imagem-capa").on('change',lerImagem);

    })($)
    let imagens = []
    
  </script>
<% end %>